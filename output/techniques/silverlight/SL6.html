<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
   <head>
      <meta charset="UTF-8" />
      <title>SL6: Defining a UI Automation Peer for a Custom Silverlight Control</title>
      <link rel="stylesheet" href="https://w3.org/WAI/assets/css/style.css?1573220675560713000" />
      <link rel="stylesheet" type="text/css" href="../base.css" />
   </head>
   <body>
      <header id="site-header" class="default-grid with-gap">
         <div class="tool-header"><span class="tool-header-name"><a href="../">WCAG 2.1: Techniques</a></span><div class="tool-header-logo"><a href="http://w3.org/"><img alt="W3C" src="https://w3.org/WAI/atag/report-tool/images/w3c.svg" width="92" height="44" /></a><a href="http://w3.org/WAI/"><img alt="Web Accessibility Initiative" src="https://w3.org//WAI/atag/report-tool/images/wai.svg" /></a></div>
         </div>
      </header>
      <main>
         <div class="default-grid leftcol">
            <nav class="nav" aria-label="Meta navigation">
               <ul>
                  <li class="nav__item"><a href="/techniques/#introduction">About Techniques</a></li>
                  <li class="nav__item"><a href="/techniques/#techniques">All Techniques</a></li>
                  <li class="nav__item"><a href="alt-index.html">All WCAG 2 Guidance 
                        									
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" height="24" width="24">
                           <path fill-rule="evenodd" clip-rule="evenodd" d="M14 5C13.4477 5 13 4.55228 13 4C13 3.44772 13.4477 3 14 3H20C20.2652 3 20.5196 3.10536 20.7071 3.29289C20.8946 3.48043 21 3.73478 21 4L21 10C21 10.5523 20.5523 11 20 11C19.4477 11 19 10.5523 19 10L19 6.41422L9.70711 15.7071C9.31658 16.0976 8.68342 16.0976 8.29289 15.7071C7.90237 15.3166 7.90237 14.6834 8.29289 14.2929L17.5858 5H14ZM3 7C3 5.89543 3.89543 5 5 5H10C10.5523 5 11 5.44772 11 6C11 6.55228 10.5523 7 10 7H5V19H17V14C17 13.4477 17.4477 13 18 13C18.5523 13 19 13.4477 19 14V19C19 20.1046 18.1046 21 17 21H5C3.89543 21 3 20.1046 3 19V7Z" fill="#282828"></path>
                        </svg></a><div id="explain-supporting-documents" hidden="">
                        <p>WCAG comes with a number of supporting documents, including Techniques and Understanding
                           documents.
                        </p>
                        <p>See also: <a href="https://www.w3.org/WAI/standards-guidelines/wcag/#whatis2">What is in the WCAG 2 Documents</a></p>
                     </div>
                  </li>
               </ul>
            </nav>
            <section class="main-content">
               <h1>Defining a UI Automation Peer for a Custom Silverlight Control</h1>
               <aside class="box">
                  <header class="box-h  box-h-icon">
                     					[icon] Sufficient
                     				
                  </header>
                  <div class="box-i">
                     <section id="applicability">
                        <p>This technique relates to <span>Sufficient to meet  as a way to meet <a href="../general/G10">G10: Creating components using a technology that supports the accessibility notification
                                 of changes</a><a href="/understanding/name-role-value">Success Criterion 4.1.2: Name, Role, Value</a></span>.
                        </p>
                     </section>
                  </div>
               </aside>
               <section id="description">
                  <h2>Description</h2>
                  <p>The objective of this technique is to create an <code class="obj">AutomationPeer</code> class
                     				for a custom Silverlight control. The <code class="obj">AutomationPeer</code> exposes
                     				accessibility properties of the control in a way that abstracts the
                     				Silverlight technology specifics of the control model and maps information
                     				to UI Automation concepts, so that these properties can be consumed
                     				by the UI Automation accessibility framework. 
                  </p>
                  <p>The AutomationPeer concept is part of the overall architecture design
                     				of the UI Automation system. The peer represents a deliberate abstraction
                     				of the control, such that a client can obtain pattern-based information
                     				about the specific purpose and capability of a control without knowing
                     				its implementation-specific object model or having to resort to using
                     				a framework-specific object model API. Also, the peers run in a different
                     				process than the controls they represent, which has performance and
                     				security advantages. For more information on UI Automation architecture,
                     				see <a href="https://msdn.microsoft.com/en-us/library/ms747327.aspx">UI
                        					Automation Overview on MSDN</a>. 
                  </p>
                  <p>Creating a custom Silverlight control is one way that Silverlight
                     				application authors can create user interface components either for
                     				their own application, or as a packaged redistributable that provides
                     				the control UI for third parties. Creating an automation peer for a
                     				custom control reports control-specific information to the UI Automation
                     				accessibility framework, and enables a custom control to participate
                     				in all of the same techniques involving UI Automation that can be used
                     				for a control that is distributed in the core Silverlight run time.
                     				Assistive technologies can use the UI Automation accessibility framework
                     				to discover the name and role of the user interface component, and
                     				can get and set values by accessing UI Automation patterns. UI Automation
                     				thus supports extensibility, while maintaining a discovery system for
                     				names, roles and values of UI components. 
                  </p>
                  <p>Control authors associate a peer with a class by implementing a method
                     				override for the class implementation. Control authors declare name
                     				and role through properties that are general to any UI Automation peer.
                     				Control authors expose the means to get and set values by choosing
                     				to support one or more patterns that are usually associated with a
                     				role. For example, a control in the role of "Button" would
                     				typically support an "Invoke" pattern. A consumer of UI Automation
                     				could check whether the pattern was supported and then call the pattern-based
                     				method Invoke, which would activate the button without
                     				any device input events being produced or required. 
                  </p>
                  <p>By convention, controls and their automation peers share a naming
                     				pattern. For example, if a control is named <code class="obj">Spinner</code>, its automation
                     				peer is named <code class="obj">SpinnerPeer</code>. However, the actual wiring for the class-peer
                     				association is made in the control code by overriding OnCreateAutomationPeer.
                     				Thus it is necessary to have access to the control code in order to
                     				associate a new peer class implementation with that control. 
                  </p>
                  <p>In addition to properties, automation peers can also expose methods
                     				as part of the implemented UI Automation control pattern. For example,
                     				a peer implementing the Value pattern can provide an implementation
                     				of the SetValue method. The SetValue method
                     				can be called by a UI Automation client in order to programmatically
                     				set the value of the owner control. The functionality exposed by the
                     				implementation of a control pattern can be accessed either by automation-based
                     				testing, or by assistive technologies. 
                  </p>
               </section>
               <section id="examples">
                  <h2>Examples</h2>
                  <section class="example" id="example-1-simplenumericupdown-control-and-its-peer">
                     <h3>Example 1: SimpleNumericUpDown control and its peer</h3>
                     <p>The example implements a very simple Silverlight custom control named
                        						SimpleNumericUpDown. The control is a templateable control, meaning
                        						that the UI is defined in a XAML file that serves as the default UI,
                        						but any consumer of the control can change the visual appearance by
                        						applying a new template. Nevertheless, the basic accessibility characteristics
                        						of the control can be shaped by the control author, and can apply even
                        						for cases where the visible UI is noticably different. This separation
                        						between design-implementation and code-behavior is one reason for the
                        						peer-owner design in UI Automation. The majority of the example shows
                        						the C# code, including the following : 
                     </p>
                     <ul>
                        
                        <li> Associating the peer with the class. </li>
                        
                        <li> Defining the peer, and basic information such as the class name. </li>
                        
                        <li> Reporting which patterns the peer supports. In this case the peer
                           						supports a Value pattern. 
                        </li>
                        
                     </ul>
                     <p>Control definition class: </p><pre xml:space="preserve">   public class SimpleNumericUpDown : Control
   {
       public SimpleNumericUpDown()
       {
           this.DefaultStyleKey = typeof(SimpleNumericUpDown);
       protected override System.Windows.Automation.Peers.AutomationPeer OnCreateAutomationPeer()
       {
           return new SimpleNumericUpDownAutomationPeer(this);
       }
 // templating and event handlers omitted
       public static DependencyProperty NumericValueProperty = DependencyProperty.Register(
           "NumericValue",
           typeof(Int32),
           typeof(SimpleNumericUpDown),
           new PropertyMetadata(0)
           );
       public Int32 NumericValue
       {
           get { return (Int32)this.GetValue(NumericValueProperty); }
           set {this.SetValue(NumericValueProperty,value);}
       }
   }
   </pre><p>Automation peer definition: </p><pre xml:space="preserve">   public class SimpleNumericUpDownAutomationPeer : FrameworkElementAutomationPeer, IValueProvider
   {
       private SimpleNumericUpDown OwnerControl { get { return (SimpleNumericUpDown)Owner; } }
       public SimpleNumericUpDownAutomationPeer(SimpleNumericUpDown owner)
           : base(owner) {}
       //peer overrides
       protected override string GetClassNameCore()
       {
           return "SimpleNumericUpDown";
       }
       protected override AutomationControlType GetAutomationControlTypeCore()
       {
           return AutomationControlType.Spinner;
       }
       public override object GetPattern(PatternInterface patternInterface) {
           if (patternInterface == PatternInterface.Value)
           {
               return this;
           }
           return base.GetPattern(patternInterface);
       }
       // Value pattern implementation
       String IValueProvider.Value
       {
           get { return OwnerControl.NumericValue.ToString(); }
       }
       bool IValueProvider.IsReadOnly {get{return false;}}
       void IValueProvider.SetValue(string value)
       {
           OwnerControl.NumericValue = Convert.ToInt32(value);
       }
</pre><p class="working-example">This example is shown in operation in the <a href="../../working-examples/silverlight-simple-numeric-up-down/">working example of Simple Numeric UpDown control</a>.
                     </p>
                  </section>
               </section>
               <section id="resources">
                  <h2>Resources</h2>
                  <p>Resources are for information purposes only, no endorsement implied.</p>
                  <ul>
                     
                     <li>
                        <a href="https://msdn.microsoft.com/en-us/library/cc645045(VS.95).aspx">UI
                           						Automation of a Silverlight Custom Control</a> 
                        
                     </li>
                     
                     <li>
                        <a href="https://msdn.microsoft.com/en-us/library/system.windows.automation.peers.frameworkelementautomationpeer%28VS.95%29.aspx">FrameworkElementAutomationPeer</a> 
                        
                     </li>
                     
                     <li>
                        <a href="https://msdn.microsoft.com/en-us/library/ms753388.aspx">Accessibility</a> 
                        
                     </li>
                     
                     <li>Tools: <a href="http://firstfloorsoftware.com/silverlightspy">SilverlightSpy</a> or <a href="http://uiautomationverify.codeplex.com/">UIAVerify</a> 
                        
                     </li>
                     
                  </ul>
               </section>
               <section id="tests">
                  <h2>Tests</h2>
                  <section class="procedure" id="procedure">
                     <h3>Procedure</h3>
                     
                     <ol>
                        
                        <li> Using a browser that supports Silverlight, open an HTML page that
                           					references a Silverlight application through an object tag. To see
                           					UI Automation, use Microsoft Windows as platform. 
                        </li>
                        
                        <li> Use a verification tool that is capable of showing the full automation
                           						tree, and an object’s UI Automation properties and patterns as part
                           						of the tree. (For example, use UIAVerify or Silverlight Spy; see
                           						Resources links.) Select the item in the automation tree that is
                           						accessing the relevant custom automation peer implementation. 
                        </li>
                        
                        <li> Examine the set of properties exposed in the tree. Check that
                           							name is reported by Name, that the class name is reported as ClassName,
                           							and that there is a role as reported by the value of ControlType. 
                        </li>
                        
                        <li> If the control is expected to report a value, check that the value
                           								is reported in the tree somehow. (Exactly which property reports
                           								the value varies depending on the control function and pattern; for
                           								more information, see <a href="https://msdn.microsoft.com/en-us/library/ff486375%28VS.85%29.aspx">Windows
                              									Automation API</a>). 
                        </li>
                        
                        <li> Check whether a control pattern is reported in the tree. If a
                           										control pattern is reported, test the methods of that pattern using
                           										facilities in the verification tool. Verify that invoking the methods
                           										has changed the corresponding read only property values in the tree. 
                        </li>
                        
                     </ol>
                     
                  </section>
                  <section class="results" id="expected-results">
                     <h3>Expected Results</h3>
                     
                     <p>#3, #4, and #5 (if applicable) are true. </p>
                     
                  </section>
               </section>
            </section>
            <aside class="your-report your-report--expanded sidebar" tabindex="-1">
               <h2 style="margin-top: 0">About this page</h2>
               <p><em>Techniques</em> are examples of ways to meet a WCAG success criterion.
               </p>
               <dl>
                  <dt>Type of technique 
                     				<button style="display: inline" type="button" data-tooltip-content="#explain-types-of-techniques"><span class="visuallyhidden">Explain types of techniques</span><span aria-hidden="true" class="more-info__icon">
                           <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 450" style="width: 1em">
                              <path fill="currentColor" d="M256 344v-40c0-4.5-3.5-8-8-8h-24v-128c0-4.5-3.5-8-8-8h-80c-4.5 0-8 3.5-8 8v40c0 4.5 3.5 8 8 8h24v80h-24c-4.5 0-8 3.5-8 8v40c0 4.5 3.5 8 8 8h112c4.5 0 8-3.5 8-8zM224 120v-40c0-4.5-3.5-8-8-8h-48c-4.5 0-8 3.5-8 8v40c0 4.5 3.5 8 8 8h48c4.5 0 8-3.5 8-8zM384 224c0 106-86 192-192 192s-192-86-192-192 86-192 192-192 192 86 192 192z"></path>
                           </svg></span></button><div id="explain-types-of-techniques" hidden="true">
                        <p>There are different types of techniques:</p>
                        <ul>
                           <li>Sufficient - reliable ways to meet a WCAG Criterion</li>
                           <li>Advisory - suggested ways to improve accessibility</li>
                           <li>Failure - things that cause accessibility barriers and fail specific success criteria</li>
                        </ul>
                        <p>Note: all techniques are “informative”, that is, you do not have to use them.</p>
                     </div>
                  </dt>
                  <dd>Sufficient</dd>
                  <dt>Sufficient to meet</dt>
                  <dd><a href="https://www.w3.org/WAI/WCAG21/quickref/?versions=2.1#info-and-relationships">1.3.1 Info and relationships</a></dd>
                  <dt>Related test rules 
                     
                     
                     <button style="display: inline" type="button" data-tooltip-content="#explain-test-rules"><span class="visuallyhidden">Explain test rules</span><span aria-hidden="true" class="more-info__icon">
                           <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 450" style="width: 1em">
                              <path fill="currentColor" d="M256 344v-40c0-4.5-3.5-8-8-8h-24v-128c0-4.5-3.5-8-8-8h-80c-4.5 0-8 3.5-8 8v40c0 4.5 3.5 8 8 8h24v80h-24c-4.5 0-8 3.5-8 8v40c0 4.5 3.5 8 8 8h112c4.5 0 8-3.5 8-8zM224 120v-40c0-4.5-3.5-8-8-8h-48c-4.5 0-8 3.5-8 8v40c0 4.5 3.5 8 8 8h48c4.5 0 8-3.5 8-8zM384 224c0 106-86 192-192 192s-192-86-192-192 86-192 192-192 192 86 192 192z"></path>
                           </svg></span></button><div id="explain-test-rules" hidden="true">WCAG Success Criteria interpreted as test rules, created by the ACT Task Force.</div>
                  </dt>
                  <dd><a href="2020-07-15-prototype-act.html">HTML page has title</a></dd>
                  <dt>Related Techniques</dt>
                  <dd>
                     <ul>
                        
                        <li><a href="/techniques/general/G10">G10: Creating components using a technology that supports the accessibility notification
                              of changes</a></li>
                        
                     </ul>
                  </dd>
               </dl>
               <h3>Other sources</h3>
               <p style="margin-top: -.5em; margin-bottom: 1.5em;"><em><small>No endorsement implied.</small></em></p>
               <ul>
                  <li>HTML 4.01 <a href="https://www.w3.org/TR/html4/struct/lists.html#h-10.2">Unordered lists (UL), ordered lists (OL), and list items (LI)</a></li>
                  <li>HTML 4.01 <a href="https://www.w3.org/TR/html4/struct/lists.html#h-10.3">Definition lists: the DL, DT, and DD elements</a></li>
               </ul>
            </aside>
         </div>
      </main>
   </body>
</html>